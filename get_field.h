/*
 *  get_field.h
 *  ringdesign
 *
 *  Copyright 2009 Kyoto University. All rights reserved.
 *
 */

#ifndef GET_FIELD 
#define GET_FIELD

#include "constants.h"
#include "common.h"

static void trilinear_interpolation(struct Map *map, int i1, int i2, int i3, int i1p, int i2p, int i3p, double dum1, double dum2, double dum3, double b[3]);
static double deru_dt(double new[], double prev[], double p[]);
static double deru_dr(double new[], double prev[], double p[], int order);
static double der2bzdz2(double r,double d1bzdr1dt0,double d2bzdr0dt2,double d2bzdr2dt0);
static double der3brdz3(double r,double d1bzdr1dt0,double d2bzdr0dt2,double d2bzdr2dt0,double d3bzdr1dt2,double d3bzdr3dt0);
static double der3btdz3(double r,double d2bzdr1dt1,double d3bzdr0dt3,double d3bzdr2dt1);
static double der4bzdz4(double r,double d1bzdr1dt0,double d2bzdr0dt2,double d2bzdr2dt0,double d3bzdr1dt2,double d3bzdr3dt0,double d4bzdr0dt4,double d4bzdr2dt2,double d4bzdr4dt0);
static double der5brdz5(double r,double d1bzdr1dt0,double d2bzdr0dt2,double d2bzdr2dt0,double d3bzdr1dt2,double d3bzdr3dt0,double d4bzdr0dt4,double d4bzdr2dt2,double d4bzdr4dt0,double d5bzdr1dt4,double d5bzdr3dt2,double d5bzdr5dt0);
static double der5btdz5(double r,double d2bzdr1dt1,double d3bzdr0dt3,double d3bzdr2dt1,double d4bzdr1dt3,double d4bzdr3dt1,double d5bzdr0dt5,double d5bzdr2dt3,double d5bzdr4dt1);
static double der6bzdz6(double r,double d1bzdr1dt0,double d2bzdr0dt2,double d2bzdr2dt0,double d3bzdr1dt2,double d3bzdr3dt0,double d4bzdr0dt4,double d4bzdr2dt2,double d4bzdr4dt0,double d5bzdr1dt4,double d5bzdr3dt2,double d5bzdr5dt0,double d6bzdr0dt6,double d6bzdr2dt4,double d6bzdr4dt2,double d6bzdr6dt0);
static double der7brdz7(double r,double d1bzdr1dt0,double d2bzdr0dt2,double d2bzdr2dt0,double d3bzdr1dt2,double d3bzdr3dt0,double d4bzdr0dt4,double d4bzdr2dt2,double d4bzdr4dt0,double d5bzdr1dt4,double d5bzdr3dt2,double d5bzdr5dt0,double d6bzdr0dt6,double d6bzdr2dt4,double d6bzdr4dt2,double d6bzdr6dt0,double d7bzdr1dt6,double d7bzdr3dt4,double d7bzdr5dt2,double d7bzdr7dt0);
static double der7btdz7(double r,double d2bzdr1dt1,double d3bzdr0dt3,double d3bzdr2dt1,double d4bzdr1dt3,double d4bzdr3dt1,double d5bzdr0dt5,double d5bzdr2dt3,double d5bzdr4dt1,double d6bzdr1dt5,double d6bzdr3dt3,double d6bzdr5dt1,double d7bzdr0dt7,double d7bzdr2dt5,double d7bzdr4dt3,double d7bzdr6dt1);
static double der8bzdz8(double r,double d1bzdr1dt0,double d2bzdr0dt2,double d2bzdr2dt0,double d3bzdr1dt2,double d3bzdr3dt0,double d4bzdr0dt4,double d4bzdr2dt2,double d4bzdr4dt0,double d5bzdr1dt4,double d5bzdr3dt2,double d5bzdr5dt0,double d6bzdr0dt6,double d6bzdr2dt4,double d6bzdr4dt2,double d6bzdr6dt0,double d7bzdr1dt6,double d7bzdr3dt4,double d7bzdr5dt2,double d7bzdr7dt0,double d8bzdr0dt8,double d8bzdr2dt6,double d8bzdr4dt4,double d8bzdr6dt2,double d8bzdr8dt0);
static double der9brdz9(double r,double d1bzdr1dt0,double d2bzdr0dt2,double d2bzdr2dt0,double d3bzdr1dt2,double d3bzdr3dt0,double d4bzdr0dt4,double d4bzdr2dt2,double d4bzdr4dt0,double d5bzdr1dt4,double d5bzdr3dt2,double d5bzdr5dt0,double d6bzdr0dt6,double d6bzdr2dt4,double d6bzdr4dt2,double d6bzdr6dt0,double d7bzdr1dt6,double d7bzdr3dt4,double d7bzdr5dt2,double d7bzdr7dt0,double d8bzdr0dt8,double d8bzdr2dt6,double d8bzdr4dt4,double d8bzdr6dt2,double d8bzdr8dt0,double d9bzdr1dt8,double d9bzdr3dt6,double d9bzdr5dt4,double d9bzdr7dt2,double d9bzdr9dt0);
static double der9btdz9(double r,double d2bzdr1dt1,double d3bzdr0dt3,double d3bzdr2dt1,double d4bzdr1dt3,double d4bzdr3dt1,double d5bzdr0dt5,double d5bzdr2dt3,double d5bzdr4dt1,double d6bzdr1dt5,double d6bzdr3dt3,double d6bzdr5dt1,double d7bzdr0dt7,double d7bzdr2dt5,double d7bzdr4dt3,double d7bzdr6dt1,double d8bzdr1dt7,double d8bzdr3dt5,double d8bzdr5dt3,double d8bzdr7dt1,double d9bzdr0dt9,double d9bzdr2dt7,double d9bzdr4dt5,double d9bzdr6dt3,double d9bzdr8dt1);
static double der10bzdz10(double r,double d1bzdr1dt0,double d2bzdr0dt2,double d2bzdr2dt0,double d3bzdr1dt2,double d3bzdr3dt0,double d4bzdr0dt4,double d4bzdr2dt2,double d4bzdr4dt0,double d5bzdr1dt4,double d5bzdr3dt2,double d5bzdr5dt0,double d6bzdr0dt6,double d6bzdr2dt4,double d6bzdr4dt2,double d6bzdr6dt0,double d7bzdr1dt6,double d7bzdr3dt4,double d7bzdr5dt2,double d7bzdr7dt0,double d8bzdr0dt8,double d8bzdr2dt6,double d8bzdr4dt4,double d8bzdr6dt2,double d8bzdr8dt0,double d9bzdr1dt8,double d9bzdr3dt6,double d9bzdr5dt4,double d9bzdr7dt2,double d9bzdr9dt0,double d10bzdr0dt10,double d10bzdr2dt8,double d10bzdr4dt6,double d10bzdr6dt4,double d10bzdr8dt2,double d10bzdr10dt0);
static double der11brdz11(double r,double d1bzdr1dt0,double d2bzdr0dt2,double d2bzdr2dt0,double d3bzdr1dt2,double d3bzdr3dt0,double d4bzdr0dt4,double d4bzdr2dt2,double d4bzdr4dt0,double d5bzdr1dt4,double d5bzdr3dt2,double d5bzdr5dt0,double d6bzdr0dt6,double d6bzdr2dt4,double d6bzdr4dt2,double d6bzdr6dt0,double d7bzdr1dt6,double d7bzdr3dt4,double d7bzdr5dt2,double d7bzdr7dt0,double d8bzdr0dt8,double d8bzdr2dt6,double d8bzdr4dt4,double d8bzdr6dt2,double d8bzdr8dt0,double d9bzdr1dt8,double d9bzdr3dt6,double d9bzdr5dt4,double d9bzdr7dt2,double d9bzdr9dt0,double d10bzdr0dt10,double d10bzdr2dt8,double d10bzdr4dt6,double d10bzdr6dt4,double d10bzdr8dt2,double d10bzdr10dt0,double d11bzdr1dt10,double d11bzdr3dt8,double d11bzdr5dt6,double d11bzdr7dt4,double d11bzdr9dt2,double d11bzdr11dt0);
static double der11btdz11(double r,double d2bzdr1dt1,double d3bzdr0dt3,double d3bzdr2dt1,double d4bzdr1dt3,double d4bzdr3dt1,double d5bzdr0dt5,double d5bzdr2dt3,double d5bzdr4dt1,double d6bzdr1dt5,double d6bzdr3dt3,double d6bzdr5dt1,double d7bzdr0dt7,double d7bzdr2dt5,double d7bzdr4dt3,double d7bzdr6dt1,double d8bzdr1dt7,double d8bzdr3dt5,double d8bzdr5dt3,double d8bzdr7dt1,double d9bzdr0dt9,double d9bzdr2dt7,double d9bzdr4dt5,double d9bzdr6dt3,double d9bzdr8dt1,double d10bzdr1dt9,double d10bzdr3dt7,double d10bzdr5dt5,double d10bzdr7dt3,double d10bzdr9dt1,double d11bzdr0dt11,double d11bzdr2dt9,double d11bzdr4dt7,double d11bzdr6dt5,double d11bzdr8dt3,double d11bzdr10dt1);
static double der12bzdz12(double r,double d1bzdr1dt0,double d2bzdr0dt2,double d2bzdr2dt0,double d3bzdr1dt2,double d3bzdr3dt0,double d4bzdr0dt4,double d4bzdr2dt2,double d4bzdr4dt0,double d5bzdr1dt4,double d5bzdr3dt2,double d5bzdr5dt0,double d6bzdr0dt6,double d6bzdr2dt4,double d6bzdr4dt2,double d6bzdr6dt0,double d7bzdr1dt6,double d7bzdr3dt4,double d7bzdr5dt2,double d7bzdr7dt0,double d8bzdr0dt8,double d8bzdr2dt6,double d8bzdr4dt4,double d8bzdr6dt2,double d8bzdr8dt0,double d9bzdr1dt8,double d9bzdr3dt6,double d9bzdr5dt4,double d9bzdr7dt2,double d9bzdr9dt0,double d10bzdr0dt10,double d10bzdr2dt8,double d10bzdr4dt6,double d10bzdr6dt4,double d10bzdr8dt2,double d10bzdr10dt0,double d11bzdr1dt10,double d11bzdr3dt8,double d11bzdr5dt6,double d11bzdr7dt4,double d11bzdr9dt2,double d11bzdr11dt0,double d12bzdr0dt12,double d12bzdr2dt10,double d12bzdr4dt8,double d12bzdr6dt6,double d12bzdr8dt4,double d12bzdr10dt2,double d12bzdr12dt0);
static double d1fdx1dy0(double u,double d1udx1dy0);
static double d2fdx1dy1(double u,double d1udx1dy0,double d1udx0dy1,double d2udx1dy1);
static double d2fdx2dy0(double u,double d1udx1dy0,double d2udx2dy0);
static double d3fdx2dy1(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d3udx2dy1);
static double d3fdx3dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0);
static double d4fdx2dy2(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx2dy1,double d3udx1dy2,double d4udx2dy2);
static double d4fdx3dy1(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d3udx3dy0,double d3udx2dy1,double d4udx3dy1);
static double d4fdx4dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0);
static double d5fdx3dy2(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d4udx3dy1,double d4udx2dy2,double d5udx3dy2);
static double d5fdx4dy1(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d3udx3dy0,double d3udx2dy1,double d4udx4dy0,double d4udx3dy1,double d5udx4dy1);
static double d5fdx5dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0,double d5udx5dy0);
static double d6fdx3dy3(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d5udx3dy2,double d5udx2dy3,double d6udx3dy3);
static double d6fdx4dy2(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d5udx4dy1,double d5udx3dy2,double d6udx4dy2);
static double d6fdx5dy1(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d3udx3dy0,double d3udx2dy1,double d4udx4dy0,double d4udx3dy1,double d5udx5dy0,double d5udx4dy1,double d6udx5dy1);
static double d6fdx6dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0,double d5udx5dy0,double d6udx6dy0);
static double d7fdx4dy3(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d5udx4dy1,double d5udx3dy2,double d5udx2dy3,double d6udx4dy2,double d6udx3dy3,double d7udx4dy3);
static double d7fdx5dy2(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d6udx5dy1,double d6udx4dy2,double d7udx5dy2);
static double d7fdx6dy1(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d3udx3dy0,double d3udx2dy1,double d4udx4dy0,double d4udx3dy1,double d5udx5dy0,double d5udx4dy1,double d6udx6dy0,double d6udx5dy1,double d7udx6dy1);
static double d7fdx7dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0,double d5udx5dy0,double d6udx6dy0,double d7udx7dy0);
static double d8fdx4dy4(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d4udx0dy4,double d5udx4dy1,double d5udx3dy2,double d5udx2dy3,double d5udx1dy4,double d6udx4dy2,double d6udx3dy3,double d6udx2dy4,double d7udx4dy3,double d7udx3dy4,double d8udx4dy4);
static double d8fdx5dy3(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d5udx2dy3,double d6udx5dy1,double d6udx4dy2,double d6udx3dy3,double d7udx5dy2,double d7udx4dy3,double d8udx5dy3);
static double d8fdx6dy2(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d6udx6dy0,double d6udx5dy1,double d6udx4dy2,double d7udx6dy1,double d7udx5dy2,double d8udx6dy2);
static double d8fdx7dy1(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d3udx3dy0,double d3udx2dy1,double d4udx4dy0,double d4udx3dy1,double d5udx5dy0,double d5udx4dy1,double d6udx6dy0,double d6udx5dy1,double d7udx7dy0,double d7udx6dy1,double d8udx7dy1);
static double d8fdx8dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0,double d5udx5dy0,double d6udx6dy0,double d7udx7dy0,double d8udx8dy0);
static double d9fdx5dy4(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d4udx0dy4,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d5udx2dy3,double d5udx1dy4,double d6udx5dy1,double d6udx4dy2,double d6udx3dy3,double d6udx2dy4,double d7udx5dy2,double d7udx4dy3,double d7udx3dy4,double d8udx5dy3,double d8udx4dy4,double d9udx5dy4);
static double d9fdx6dy3(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d5udx2dy3,double d6udx6dy0,double d6udx5dy1,double d6udx4dy2,double d6udx3dy3,double d7udx6dy1,double d7udx5dy2,double d7udx4dy3,double d8udx6dy2,double d8udx5dy3,double d9udx6dy3);
static double d9fdx7dy2(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d6udx6dy0,double d6udx5dy1,double d6udx4dy2,double d7udx7dy0,double d7udx6dy1,double d7udx5dy2,double d8udx7dy1,double d8udx6dy2,double d9udx7dy2);
static double d9fdx8dy1(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d3udx3dy0,double d3udx2dy1,double d4udx4dy0,double d4udx3dy1,double d5udx5dy0,double d5udx4dy1,double d6udx6dy0,double d6udx5dy1,double d7udx7dy0,double d7udx6dy1,double d8udx8dy0,double d8udx7dy1,double d9udx8dy1);
static double d9fdx9dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0,double d5udx5dy0,double d6udx6dy0,double d7udx7dy0,double d8udx8dy0,double d9udx9dy0);
static double d10fdx5dy5(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d4udx0dy4,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d5udx2dy3,double d5udx1dy4,double d5udx0dy5,double d6udx5dy1,double d6udx4dy2,double d6udx3dy3,double d6udx2dy4,double d6udx1dy5,double d7udx5dy2,double d7udx4dy3,double d7udx3dy4,double d7udx2dy5,double d8udx5dy3,double d8udx4dy4,double d8udx3dy5,double d9udx5dy4,double d9udx4dy5,double d10udx5dy5);
static double d10fdx6dy4(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d4udx0dy4,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d5udx2dy3,double d5udx1dy4,double d6udx6dy0,double d6udx5dy1,double d6udx4dy2,double d6udx3dy3,double d6udx2dy4,double d7udx6dy1,double d7udx5dy2,double d7udx4dy3,double d7udx3dy4,double d8udx6dy2,double d8udx5dy3,double d8udx4dy4,double d9udx6dy3,double d9udx5dy4,double d10udx6dy4);
static double d10fdx7dy3(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d5udx2dy3,double d6udx6dy0,double d6udx5dy1,double d6udx4dy2,double d6udx3dy3,double d7udx7dy0,double d7udx6dy1,double d7udx5dy2,double d7udx4dy3,double d8udx7dy1,double d8udx6dy2,double d8udx5dy3,double d9udx7dy2,double d9udx6dy3,double d10udx7dy3);
static double d10fdx8dy2(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d6udx6dy0,double d6udx5dy1,double d6udx4dy2,double d7udx7dy0,double d7udx6dy1,double d7udx5dy2,double d8udx8dy0,double d8udx7dy1,double d8udx6dy2,double d9udx8dy1,double d9udx7dy2,double d10udx8dy2);
static double d10fdx9dy1(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d3udx3dy0,double d3udx2dy1,double d4udx4dy0,double d4udx3dy1,double d5udx5dy0,double d5udx4dy1,double d6udx6dy0,double d6udx5dy1,double d7udx7dy0,double d7udx6dy1,double d8udx8dy0,double d8udx7dy1,double d9udx9dy0,double d9udx8dy1,double d10udx9dy1);
static double d10fdx10dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0,double d5udx5dy0,double d6udx6dy0,double d7udx7dy0,double d8udx8dy0,double d9udx9dy0,double d10udx10dy0);
static double d11fdx6dy5(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d4udx0dy4,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d5udx2dy3,double d5udx1dy4,double d5udx0dy5,double d6udx6dy0,double d6udx5dy1,double d6udx4dy2,double d6udx3dy3,double d6udx2dy4,double d6udx1dy5,double d7udx6dy1,double d7udx5dy2,double d7udx4dy3,double d7udx3dy4,double d7udx2dy5,double d8udx6dy2,double d8udx5dy3,double d8udx4dy4,double d8udx3dy5,double d9udx6dy3,double d9udx5dy4,double d9udx4dy5,double d10udx6dy4,double d10udx5dy5,double d11udx6dy5);
static double d11fdx7dy4(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d4udx0dy4,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d5udx2dy3,double d5udx1dy4,double d6udx6dy0,double d6udx5dy1,double d6udx4dy2,double d6udx3dy3,double d6udx2dy4,double d7udx7dy0,double d7udx6dy1,double d7udx5dy2,double d7udx4dy3,double d7udx3dy4,double d8udx7dy1,double d8udx6dy2,double d8udx5dy3,double d8udx4dy4,double d9udx7dy2,double d9udx6dy3,double d9udx5dy4,double d10udx7dy3,double d10udx6dy4,double d11udx7dy4);
static double d11fdx8dy3(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d5udx2dy3,double d6udx6dy0,double d6udx5dy1,double d6udx4dy2,double d6udx3dy3,double d7udx7dy0,double d7udx6dy1,double d7udx5dy2,double d7udx4dy3,double d8udx8dy0,double d8udx7dy1,double d8udx6dy2,double d8udx5dy3,double d9udx8dy1,double d9udx7dy2,double d9udx6dy3,double d10udx8dy2,double d10udx7dy3,double d11udx8dy3);
static double d11fdx9dy2(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d6udx6dy0,double d6udx5dy1,double d6udx4dy2,double d7udx7dy0,double d7udx6dy1,double d7udx5dy2,double d8udx8dy0,double d8udx7dy1,double d8udx6dy2,double d9udx9dy0,double d9udx8dy1,double d9udx7dy2,double d10udx9dy1,double d10udx8dy2,double d11udx9dy2);
static double d11fdx10dy1(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d3udx3dy0,double d3udx2dy1,double d4udx4dy0,double d4udx3dy1,double d5udx5dy0,double d5udx4dy1,double d6udx6dy0,double d6udx5dy1,double d7udx7dy0,double d7udx6dy1,double d8udx8dy0,double d8udx7dy1,double d9udx9dy0,double d9udx8dy1,double d10udx10dy0,double d10udx9dy1,double d11udx10dy1);
static double d11fdx11dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0,double d5udx5dy0,double d6udx6dy0,double d7udx7dy0,double d8udx8dy0,double d9udx9dy0,double d10udx10dy0,double d11udx11dy0);
static double d12fdx6dy6(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d4udx0dy4,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d5udx2dy3,double d5udx1dy4,double d5udx0dy5,double d6udx6dy0,double d6udx5dy1,double d6udx4dy2,double d6udx3dy3,double d6udx2dy4,double d6udx1dy5,double d6udx0dy6,double d7udx6dy1,double d7udx5dy2,double d7udx4dy3,double d7udx3dy4,double d7udx2dy5,double d7udx1dy6,double d8udx6dy2,double d8udx5dy3,double d8udx4dy4,double d8udx3dy5,double d8udx2dy6,double d9udx6dy3,double d9udx5dy4,double d9udx4dy5,double d9udx3dy6,double d10udx6dy4,double d10udx5dy5,double d10udx4dy6,double d11udx6dy5,double d11udx5dy6,double d12udx6dy6);
static double d12fdx8dy4(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d3udx0dy3,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d4udx1dy3,double d4udx0dy4,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d5udx2dy3,double d5udx1dy4,double d6udx6dy0,double d6udx5dy1,double d6udx4dy2,double d6udx3dy3,double d6udx2dy4,double d7udx7dy0,double d7udx6dy1,double d7udx5dy2,double d7udx4dy3,double d7udx3dy4,double d8udx8dy0,double d8udx7dy1,double d8udx6dy2,double d8udx5dy3,double d8udx4dy4,double d9udx8dy1,double d9udx7dy2,double d9udx6dy3,double d9udx5dy4,double d10udx8dy2,double d10udx7dy3,double d10udx6dy4,double d11udx8dy3,double d11udx7dy4,double d12udx8dy4);
static double d12fdx10dy2(double u,double d1udx1dy0,double d1udx0dy1,double d2udx2dy0,double d2udx1dy1,double d2udx0dy2,double d3udx3dy0,double d3udx2dy1,double d3udx1dy2,double d4udx4dy0,double d4udx3dy1,double d4udx2dy2,double d5udx5dy0,double d5udx4dy1,double d5udx3dy2,double d6udx6dy0,double d6udx5dy1,double d6udx4dy2,double d7udx7dy0,double d7udx6dy1,double d7udx5dy2,double d8udx8dy0,double d8udx7dy1,double d8udx6dy2,double d9udx9dy0,double d9udx8dy1,double d9udx7dy2,double d10udx10dy0,double d10udx9dy1,double d10udx8dy2,double d11udx10dy1,double d11udx9dy2,double d12udx10dy2);
static double d12fdx12dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0,double d5udx5dy0,double d6udx6dy0,double d7udx7dy0,double d8udx8dy0,double d9udx9dy0,double d10udx10dy0,double d11udx11dy0,double d12udx12dy0);
static double d13fdx13dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0,double d5udx5dy0,double d6udx6dy0,double d7udx7dy0,double d8udx8dy0,double d9udx9dy0,double d10udx10dy0,double d11udx11dy0,double d12udx12dy0,double d13udx13dy0);
static double d14fdx14dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0,double d5udx5dy0,double d6udx6dy0,double d7udx7dy0,double d8udx8dy0,double d9udx9dy0,double d10udx10dy0,double d11udx11dy0,double d12udx12dy0,double d13udx13dy0,double d14udx14dy0);
static double d15fdx15dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0,double d5udx5dy0,double d6udx6dy0,double d7udx7dy0,double d8udx8dy0,double d9udx9dy0,double d10udx10dy0,double d11udx11dy0,double d12udx12dy0,double d13udx13dy0,double d14udx14dy0,double d15udx15dy0);
static double d16fdx16dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0,double d5udx5dy0,double d6udx6dy0,double d7udx7dy0,double d8udx8dy0,double d9udx9dy0,double d10udx10dy0,double d11udx11dy0,double d12udx12dy0,double d13udx13dy0,double d14udx14dy0,double d15udx15dy0,double d16udx16dy0);
static double d17fdx17dy0(double u,double d1udx1dy0,double d2udx2dy0,double d3udx3dy0,double d4udx4dy0,double d5udx5dy0,double d6udx6dy0,double d7udx7dy0,double d8udx8dy0,double d9udx9dy0,double d10udx10dy0,double d11udx11dy0,double d12udx12dy0,double d13udx13dy0,double d14udx14dy0,double d15udx15dy0,double d16udx16dy0,double d17udx17dy0);
static double p_enge(double c[], double d);
static double d1p_enge_dd1(double c[], double d);
static double d2p_enge_dd2(double c[], double d);
static double d3p_enge_dd3(double c[], double d);
static double d4p_enge_dd4(double c[], double d);
static double d5p_enge_dd5(double c[]);
//static double dnddrn(double a, double r, int order);
//static double wd(double p[]);
//static double d1wdd1(double p[]);
//static double d2wdd2(double p[]);
//static double d3wdd3(double p[]);
//static double d4wdd4(double p[]);
//static double d5wdd5(double p[]);
//static double d6wdd6(double p[]);
//static double d7wdd7(double p[]);
//static double d8wdd8(double p[]);
//static double d9wdd9(double p[]);
//static double d10wdd10(double p[]);

static void comp_field_vffa_rect_enge_polynom(double x, double y, double z, double *bx, double *by, double *bz, int order, double bz0, double m, double ffbe, double ffbs, double ae, double as, double z_0);
static void comp_field_vffa_sect_enge_polynom(double r, double th, double z, double *br, double *bth, double *bz_loc, int order, double bz0, double m, double ffbe, double ffbs, double rlce, double rlcs, double r_0, double z_0);
static void comp_field_vffa_rect_enge_add(double x, double y, double z, double *bx, double *by, double *bz, int order, double bz0, double m, double ffbe, double ffbs, double ae, double as, double z_0);
static void comp_field_straightFFA_add(double x, double y, double z, double *bx, double *by, double *bz, int order, double bz0, double m, double ffbe, double ffbs, double ae, double as, double x_0);
static void comp_field_vffa_rect_atan_add(double x, double y, double z, double *bx, double *by, double *bz, int order, double bz0, double m, double ffbe, double ffbs, double lambda, double z_0);
static void comp_field_vffa_rect_he(double x, double z, double *bx, double *bz, int order, double bz0, double m, double z_0);
static void comp_field_vffa_rect_lin(double x, double z, double *bx, double *by, double *bz, int order, double bz0, double m, double z_0, double f0, double fp0);

	//printf("bx: 000: %le, 010: %le, 100: %le, 110: %le\n", map->node[i1][i2][i3].b[0], map->node[i1][i2p][i3].b[0], map->node[i1p][i2][i3].b[0], map->node[i1p][i2p][i3].b[0]);
	//printf("bx: 001: %le, 011: %le, 101: %le, 111: %le\n\n", map->node[i1][i2][i3p].b[0], map->node[i1][i2p][i3p].b[0], map->node[i1p][i2][i3p].b[0], map->node[i1p][i2p][i3p].b[0]);
	//printf("by: 000: %le, 010: %le, 100: %le, 110: %le\n", map->node[i1][i2][i3].b[1], map->node[i1][i2p][i3].b[1], map->node[i1p][i2][i3].b[1], map->node[i1p][i2p][i3].b[1]);
	//printf("by: 001: %le, 011: %le, 101: %le, 111: %le\n\n", map->node[i1][i2][i3p].b[1], map->node[i1][i2p][i3p].b[1], map->node[i1p][i2][i3p].b[1], map->node[i1p][i2p][i3p].b[1]);
	//printf("bz: 000: %le, 010: %le, 100: %le, 110: %le\n", map->node[i1][i2][i3].b[2], map->node[i1][i2p][i3].b[2], map->node[i1p][i2][i3].b[2], map->node[i1p][i2p][i3].b[2]);
	//printf("bz: 001: %le, 011: %le, 101: %le, 111: %le\n\n", map->node[i1][i2][i3p].b[2], map->node[i1][i2p][i3p].b[2], map->node[i1p][i2][i3p].b[2], map->node[i1p][i2p][i3p].b[2]);
	//*/

#endif
